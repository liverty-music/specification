syntax = "proto3";

package liverty_music.rpc.user.v1;

import "buf/validate/validate.proto";
import "liverty_music/entity/v1/user.proto";

// UserService provides operations for managing user accounts and profiles.
service UserService {
  // Get retrieves the profile information for a specific user.
  //
  // Possible errors:
  // - NOT_FOUND: No user was found with the specified identifier.
  // - INVALID_ARGUMENT: The provided user identifier is malformed.
  rpc Get(GetRequest) returns (GetResponse);

  // Create registers a new user profile in the system.
  //
  // Possible errors:
  // - ALREADY_EXISTS: A user with the same unique identifier or email already exists.
  // - INVALID_ARGUMENT: The provided user data is missing required fields or is malformed.
  rpc Create(CreateRequest) returns (CreateResponse);
}

// GetRequest is the request for retrieving a user's profile information.
message GetRequest {
  // Required. The unique identifier of the user to be retrieved.
  entity.v1.UserId user_id = 1 [(buf.validate.field).required = true];
}

// GetResponse contains the profile information of the requested user.
message GetResponse {
  // The user entity representing the requested profile.
  entity.v1.User user = 1 [(buf.validate.field).required = true];
}

// CreateRequest provides the necessary details to register a new user profile.
message CreateRequest {
  // Required. The identity provider's user identifier (Zitadel sub claim).
  entity.v1.UserExternalId external_id = 1 [(buf.validate.field).required = true];

  // Required. The user's email address for account identity.
  entity.v1.UserEmail email = 2 [(buf.validate.field).required = true];
}

// CreateResponse returns the user profile as successfully created.
message CreateResponse {
  // The newly created user entity, including its assigned identifier.
  entity.v1.User user = 1 [(buf.validate.field).required = true];
}
